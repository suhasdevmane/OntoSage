version: "3.1"

intents:
  - greet
  - goodbye
  - affirm
  - deny
  - mood_great
  - mood_unhappy
  - bot_challenge
  - Questions_to_brickbot
  - provide_sensor_type
  - provide_start_date
  - provide_end_date
  - test_action_server
  
entities:
  - sensor_type
  - time:
      roles:
        - start
        - end

slots:
  sensor_type:
    type: list
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: sensor_type
  date_range_mode:
    type: text
    influence_conversation: true
    mappings:
      - type: from_text
        conditions:
          - active_loop: date_range_choice_form
  analytics_type:
    type: text
    influence_conversation: true
    mappings:
      - type: custom
  start_date:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: time
        role: start
      - type: from_entity
        entity: time
        role: end
        conditions:
          - active_loop: dates_form
          - requested_slot: start_date
  end_date:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: time
        role: end
      - type: from_entity
        entity: time
        role: start
        conditions:
          - active_loop: dates_form
          - requested_slot: end_date
  request_dates:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: from_intent
        intent: Questions_to_brickbot
        value: true
      - type: from_intent
        intent: provide_sensor_type
        value: false
      - type: from_intent
        intent: provide_start_date
        value: true
      - type: from_intent
        intent: provide_end_date
        value: true
  timeseries_ids:
    type: list
    influence_conversation: true
    mappings:
      - type: custom
  sparql_error:
    type: bool
    initial_value: false
    influence_conversation: true
    mappings:
      - type: custom

  generated_urls:
    type: any
    influence_conversation: false
    mappings:
      - type: custom

responses:
  utter_greet:
    - text: "Hey! How are you?"
  utter_cheer_up:
    - text: "Here is something to cheer you up:"
      image: "https://i.pinimg.com/564x/8d/dc/22/8ddc229afcaaa36e6bc53e15c3af2113.jpg"
  utter_did_that_help:
    - text: "Did that help you?"
  utter_happy:
    - text: "Great, carry on!"
  utter_goodbye:
    - text: "Bye"
  utter_ask_sensor_type:
    - text: "Please provide one or more valid sensor types (e.g., CO2_Level_Sensor or Air_Temperature_Sensor)."
  utter_ask_start_date:
    - text: "Please provide the start date (e.g., 01/02/2025 or 01/02/2025 00:00:00)."
  utter_ask_end_date:
    - text: "Please provide the end date (e.g., 02/02/2025 or 02/02/2025 23:59:59)."
  utter_ask_date_range_mode:
    - text: "For this analysis I can use the last 24 hours of data. Is that okay? Reply 'yes' (or 'last 24 hours') to proceed, or provide a start and end date (e.g., 01/02/2025 to 02/02/2025). If you prefer another range you can also say 'no' and I'll ask for specific dates."
  utter_translation_error:
    - text: "Sorry, I couldn't translate your query into a valid SPARQL query. Please try again."
  utter_iamabot:
    - text: "I am a bot, but I can help you with sensor data analysis."
  utter_no_dates_needed:
    - text: "No dates required for this query. Processing your request..."
 
actions:
  - action_question_to_brickbot
  - action_process_timeseries
  - action_generate_and_share_data
  - validate_sensor_form
  - validate_dates_form
  - validate_date_range_choice_form
  - action_route_after_date_choice
  - action_reset_slots
  - action_debug_entities

forms:
  sensor_form:
    required_slots:
      - sensor_type
  dates_form:
    required_slots:
      - start_date
      - end_date
  date_range_choice_form:
    required_slots:
      - date_range_mode

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: false
